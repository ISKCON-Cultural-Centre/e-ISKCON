
<div fxLayout="row" fxLayoutAlign="space-evenly" class="flex-container wrap">
    <mat-accordion class="example-headers-align">
        <mat-expansion-panel [expanded]="step === 0" (opened)="setStep(0)" hideToggle="true">
          <mat-expansion-panel-header>
            <mat-panel-title>
              Personal Details
            </mat-panel-title>
            <mat-panel-description>
              Name, Gothra, Nakshatra, Contact Numbers, Email........
              <mat-icon>account_circle</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <mat-action-row>
            <div>
                <div *ngIf="devoteeForm.value.id != null && editMode == true">
                  <button type = "button" mat-raised-button color="primary" (click)="save()">Update</button>
                </div>
                <div *ngIf="!editMode && !newDevotee">
                    <button type = "button" [disabled]="editMode" mat-raised-button color="warn" (click)="editDevotee()">Edit</button>                
                </div>                
                <div *ngIf="newDevotee">
                    <button type = "button" mat-raised-button color="primary" (click)="addDevotee()">Create</button>
                    <button type = "button" mat-raised-button color="warn" (click)="reset()">Reset</button>
                </div>
            </div>                
            <button mat-button color="primary" (click)="nextStep()">Next</button>
          </mat-action-row>           
          <form [formGroup]="devoteeForm" novalidate>  
            <fieldset class="wrap">
                <mat-form-field>
                  <input matInput placeholder="Legal Name" class="form-control" formControlName="legalName" autofocus>
                </mat-form-field>
                <mat-form-field>
                  <input matInput placeholder="Spiritual Name" class="form-control" formControlName="spiritualName">
                </mat-form-field>
                <mat-form-field>
                  <mat-select placeholder="Circle/Sector"   aria-label="State" class="form-control" formControlName="organizationId">
                    <mat-option *ngFor="let org of organizationTree " [value]="org.id">
                      <span>{{ ".....".repeat(org.depth) + org.name }}</span>
                    </mat-option>
                  </mat-select>
                </mat-form-field>
                <mat-form-field>
                    <mat-select placeholder="Gender"  class="form-control" formControlName="gender">
                      <mat-option value="M">
                        Male
                      </mat-option>
                      <mat-option value="F">
                          Female
                        </mat-option>              
                    </mat-select>
                  </mat-form-field>
                <mat-form-field>
                  <input matInput placeholder="Email Address"  class="form-control" formControlName="email">
                </mat-form-field>
                <mat-form-field>
                  <input matInput placeholder="Mobile number"  class="form-control" formControlName="mobileNo">
                </mat-form-field>
                <mat-form-field>
                  <input matInput placeholder="Landline number"  class="form-control" formControlName="landlineNo">
                </mat-form-field>                    
                <mat-form-field>
                  <input matInput placeholder="Gothra" [matAutocomplete]="autoGothra" formControlName="gothra">
                  <mat-autocomplete #autoGothra="matAutocomplete" >
                    <mat-option *ngFor="let gothra of filteredGothras | async" [value]="gothra.gothra">
                      <span>{{ gothra.gothra }}</span>
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>
                <mat-form-field>
                  <input matInput placeholder="Nakshatra" [matAutocomplete]="autoNakshatra" formControlName="nakshatra">
                  <mat-autocomplete #autoNakshatra="matAutocomplete" >
                    <mat-option *ngFor="let nakshatra of filteredNakshatras | async" [value]="nakshatra.nakshatra">
                      <span>{{ nakshatra.nakshatra }}</span>
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>
                <mat-form-field>
                  <input matInput placeholder="Profession" [matAutocomplete]="autoProfession"   formControlName="professionId">
                  <mat-autocomplete #autoProfession="matAutocomplete" [displayWith]="displayFn">
                    <mat-option *ngFor="let profession of filteredProfessions | async" [value]="profession.professionId">
                      <span>{{ profession.professionName }}</span>
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>        
                <mat-form-field>
                  <mat-select placeholder="Mother Tongue"   class="form-control" formControlName="motherTongueLanguageId">
                      <mat-option *ngFor="let language of languages" [value]="language.id">
                        <span>{{ language.language }}</span>
                      </mat-option>
                  </mat-select>        
                </mat-form-field>            
                <mat-form-field>
                  <input matInput placeholder="Aadhar number"  class="form-control" formControlName="governmentUniqueId">
                </mat-form-field>
                <mat-form-field>
                  <input matInput placeholder="PAN"  class="form-control" formControlName="incomeTaxId">
                </mat-form-field>
                <mat-form-field>
                  <input matInput placeholder="LPM Number"  class="form-control" formControlName="lpmId">
                </mat-form-field>
                <mat-form-field>
                  <input matInput [matDatepicker]="picker" placeholder="Date of Birth" class="form-control" formControlName="dateOfBirth">
                  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>
                <mat-form-field>
                  <input matInput [matDatepicker]="kcpicker" placeholder="KC start date" class="form-control" formControlName="kcAssociationDate">
                  <mat-datepicker-toggle matSuffix [for]="kcpicker"></mat-datepicker-toggle>
                  <mat-datepicker #kcpicker></mat-datepicker>
                </mat-form-field>
                <mat-form-field>
                  <mat-select placeholder="Asrama"   aria-label="State" class="form-control" formControlName="asramaMasterId">
                    <mat-option *ngFor="let asrama of asramas" [value]="asrama.id">
                      <span>{{ asrama.asramaName }}</span>
                    </mat-option>
                </mat-select>  
                </mat-form-field>        
      <!--           <mat-form-field>
                    <input type="number" matInput placeholder="Credit Limit" class="form-control" formControlName="creditLimit">
                  </mat-form-field>    -->    
              </fieldset>
           
        </form>   
              
        </mat-expansion-panel>
      
        <mat-expansion-panel [expanded]="step === 1" (opened)="setStep(1)" hideToggle="true">
          <mat-expansion-panel-header>
            <mat-panel-title>
              Address
            </mat-panel-title>
            <mat-panel-description>
              Postal Address Details
              <mat-icon>location_on</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>
      
          <div class="box">
              <fieldset fxLayout="column" fxLayoutAlign="space-evenly stretch" >
                <app-physical-address (newAddress)="updateDevoteeAddressId($event)" [physicalAddress]="physicalAddress" ></app-physical-address>
              </fieldset>
            </div>
        
      
          <mat-action-row>
            <button mat-button color="warn" (click)="prevStep()">Previous</button>
            <button mat-button color="primary" (click)="nextStep()">Next</button>
          </mat-action-row>
        </mat-expansion-panel>
      
<!--         <mat-expansion-panel [expanded]="step === 2" (opened)="setStep(2)" hideToggle="true">
          <mat-expansion-panel-header>
            <mat-panel-title>
              Family Details
            </mat-panel-title>
            <mat-panel-description>
              Children, Parents, Siblings
              <mat-icon>supervisor_account</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>
      
          <fieldset fxLayout="column" fxLayoutAlign="space-evenly stretch">
              <mat-form-field>
                <input matInput placeholder="Name">
              </mat-form-field>
              <mat-form-field>
                <input matInput placeholder="Relation">
              </mat-form-field>
            </fieldset>

          <mat-action-row>
            <button mat-button color="warn" (click)="prevStep()">Previous</button>
            <button mat-button color="primary" (click)="nextStep()">Next</button>
          </mat-action-row>
        </mat-expansion-panel> -->

        <mat-expansion-panel [expanded]="step === 3" (opened)="setStep(3)" hideToggle="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                Skill Details
              </mat-panel-title>
              <mat-panel-description>
                Skills relevant to Services at the temple
                <mat-icon>build</mat-icon>
              </mat-panel-description>
            </mat-expansion-panel-header>
            <fieldset fxLayout="column" fxLayoutAlign="space-evenly stretch">
                <app-devotee-skill [devoteeId]="devoteeId" ></app-devotee-skill>
            </fieldset>
            <mat-action-row>
              <button mat-button color="warn" (click)="prevStep()">Previous</button>
              <button mat-button color="primary" (click)="nextStep()">Next</button>
            </mat-action-row>
          </mat-expansion-panel>        

          <mat-expansion-panel [expanded]="step === 4" (opened)="setStep(4)" hideToggle="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Language Proficiency
                </mat-panel-title>
                <mat-panel-description>
                  Details of Languages able to speak, read, write
                  <mat-icon>language</mat-icon>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <fieldset fxLayout="column" fxLayoutAlign="space-evenly">
                <app-devotee-language [devoteeId]="devoteeId" ></app-devotee-language>
              </fieldset>                
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>             

          <mat-expansion-panel [expanded]="step === 5" (opened)="setStep(5)" hideToggle="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Services Interested
                </mat-panel-title>
                <mat-panel-description>
                  Choose the services you like
                  <mat-icon>pan_tool</mat-icon>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <fieldset fxLayout="column" fxLayoutAlign="space-evenly stretch">
                <app-devotee-service-interest [devotee]="devotee" ></app-devotee-service-interest>
              </fieldset>          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>   

<!--              <mat-expansion-panel [expanded]="step === 6" (opened)="setStep(6)" hideToggle="true">
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Availability for Services
                  </mat-panel-title>
                  <mat-panel-description>
                    Indicate your weekly time allocation for services
                    <mat-icon>date_range</mat-icon>
                  </mat-panel-description>
                </mat-expansion-panel-header>
            
                  
                <mat-action-row>
                  <button mat-button color="warn" (click)="prevStep()">Previous</button>
                  <button mat-button color="primary" (click)="nextStep()">End</button>
                </mat-action-row>
              </mat-expansion-panel>   --> 

      </mat-accordion>     
</div>